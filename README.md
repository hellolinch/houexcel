# 界址点成果表批量整理导出工具

## 项目简介

本工具基于 Electron + ExcelJS 开发，专为“界址点成果表”Excel文件的批量整理与导出而设计。
支持一键批量处理多个Excel文件，自动完成内容规范、敏感行隐藏、格式保持，并导出新成果表。
**内置登录密码保护，保障数据安全。**

---

## 主要功能

- **批量处理**：自动遍历输入文件夹下所有 `.xls`/`.xlsx` 文件，逐个处理。
- **内容规范**：
  - “宗地号”自动替换为“地块编号”，仅保留编号后三位。
  - “宗地面积”自动替换为“地块面积”。
  - 自动隐藏“权利人”、“建筑占地”、“制表/校审/日期”等敏感或冗余行。
- **格式保持**：所有处理均在原有Excel格式基础上进行，最大程度保留原始排版、样式、合并单元格等。
- **日志输出**：每一步处理、异常、结果均详细输出到日志窗口，便于追踪。
- **安全登录**：启动后需输入密码（默认：`xa202377..`），三次错误自动退出，防止未授权使用。
- **现代UI**：简洁美观的界面，支持深色渐变登录页、动画反馈、操作便捷。

---

## 使用方法

### 1. 便携版启动

1. 解压 `dist/win-unpacked` 文件夹到任意目录（如U盘、桌面等）。
2. 双击 `界址点成果表处理工具.exe` 启动程序。

### 2. 登录

- 启动后进入登录界面，输入密码
- 三次输入错误将自动退出程序。

### 3. 批量处理

1. 进入主界面后，点击“选择文件夹”选择待处理的Excel文件夹（支持批量）。
2. 选择输出文件夹（用于保存处理后的成果表）。
3. 点击“开始处理”，等待日志窗口显示进度。
4. 处理完成后，所有新成果表将以“原文件名_成果表.xlsx”形式保存在输出文件夹。

### 4. 其他操作

- “停止”：中断当前批量处理。
- “清空日志”：清除日志窗口内容。

---

## 打包与开发

### 依赖环境

- Node.js 16+
- Windows 10/11
- 推荐使用 PowerShell

### 本地开发

```bash
npm install
npm start
```

### 生成便携版（免安装绿色版）

1. 安装依赖（如未安装）：
   ```bash
   npm install
   ```
2. 打包免安装版：
   ```powershell
   npm run build-dir
   ```
3. 便携版输出目录：`dist/win-unpacked/`

---

## 目录结构

```
houexcel/
├─ main.js                # 主进程入口
├─ package.json           # 项目配置
├─ renderer/              # 前端界面与逻辑
│  ├─ index.html          # 主界面
│  ├─ renderer.js         # 主界面逻辑
│  ├─ style.css           # 主界面样式
│  ├─ login.html          # 登录界面
│  ├─ login.js            # 登录逻辑
│  └─ login.css           # 登录样式
└─ dist/win-unpacked/     # 免安装版输出目录
   └─ 界址点成果表处理工具.exe  # 主程序
```

---

## 安全说明

- **密码保护**：所有功能需登录后方可使用，防止未授权操作。
- **本地处理**：所有Excel文件处理均在本地完成，不上传任何数据，保障隐私安全。
- **三次错误退出**：防止暴力破解。

---

## 常见问题

- **启动无反应/闪退**：请确认已解压全部文件，且路径无中文或空格。
- **处理速度慢**：大批量文件建议分批处理，避免内存占用过高。
- **杀毒软件误报**：因未签名，部分杀毒软件可能误报，添加信任即可。

---

## 联系与支持

如需定制开发、功能扩展或遇到BUG，欢迎联系开发者。

---

如需英文版或更详细的开发文档，请告知！ 